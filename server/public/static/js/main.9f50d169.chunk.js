(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{276:function(e,t,a){e.exports=a(516)},282:function(e,t,a){},299:function(e,t,a){},516:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(49),l=a.n(o),c=a(8),i=a(9),s=a(11),u=a(10),m=(a(281),a(282),a(78)),d=a.n(m),h=function e(){var t=this;Object(c.a)(this,e),this.login=function(e){return t.service.post("/login",e)},this.signup=function(e){return t.service.post("/signup",e)},this.logout=function(){return t.service.post("/logout")},this.isLoggedIn=function(){return t.service.get("/loggedin")},this.service=d.a.create({baseURL:"".concat("https://geomapping-1.herokuapp.com/api"),withCredentials:!0})},p=a(15),g=a(103),E=a(66),f=a(261),v=a(14),b=(a(299),a(96)),S=a.n(b),y=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).logout=function(){n.AuthService.logout().then((function(){n.props.setTheUser(!1),n.props.handleToast(!0,"Usuario desconectado")})).catch((function(e){return console.log(e)}))},n.AuthService=new h,n}return Object(i.a)(a,[{key:"render",value:function(){return r.a.createElement(g.a,{bg:"dark",variant:"dark",expand:"lg",sticky:"top"},r.a.createElement(g.a.Brand,null,r.a.createElement(v.b,{to:"/"},r.a.createElement("img",{className:"navLogo",src:S.a,alt:"GeologistLogo"})," GeoMapping_")),r.a.createElement(g.a.Toggle,{"aria-controls":"basic-navbar-nav"}),r.a.createElement(g.a.Collapse,{id:"basic-navbar-nav"},r.a.createElement(E.a,{className:"ml-auto"},this.props.loggedInUser?r.a.createElement(r.a.Fragment,null,r.a.createElement(E.a.Link,{as:"span"},r.a.createElement(v.c,{to:"/myRoutes",activeStyle:{color:"white"}},"Your Routes")),r.a.createElement(E.a.Link,{as:"span"},r.a.createElement(v.c,{to:"/createRoute",activeStyle:{color:"white"}},"Create a new route")),r.a.createElement(E.a.Link,{as:"span"},r.a.createElement("span",{onClick:this.logout},"Log Out")),r.a.createElement(E.a.Link,{as:"span"},r.a.createElement(v.c,{to:"/profile/".concat(this.props.loggedInUser._id),activeStyle:{color:"white"}},r.a.createElement(f.a,{className:"navAvatar",src:this.props.loggedInUser.avatar,roundedCircle:!0})))):r.a.createElement(r.a.Fragment,null,r.a.createElement(E.a.Link,{as:"span"},r.a.createElement(v.c,{to:"/signup",activeStyle:{color:"white"}},"Sign Up")),r.a.createElement(E.a.Link,{as:"span"},r.a.createElement(v.c,{to:"/login",activeStyle:{color:"white"}},"Log In"))))))}}]),a}(n.Component),k=a(20),C=function e(){var t=this;Object(c.a)(this,e),this.handleUpload=function(e){return t.service.post("/upload",e)},this.service=d.a.create({baseURL:"".concat("https://geomapping-1.herokuapp.com/api","/files"),withCredentials:!0})},I=a(21),O=a(5),j=a(31),R=a(13),w=a(12),L=function(e){return r.a.createElement(j.a,{as:"main"},r.a.createElement(R.a,null,r.a.createElement(w.a,{md:{offset:3,span:6}},r.a.createElement("h3",null,"User"),r.a.createElement("hr",null),r.a.createElement(O.a,{onSubmit:e.onSubmit},r.a.createElement(O.a.Group,null,r.a.createElement(O.a.Label,null,"User Name"),r.a.createElement(O.a.Control,{onChange:e.inputChange,value:e.username,name:"username",type:"text"})),r.a.createElement(O.a.Group,null,r.a.createElement(O.a.Label,null,"Password"),r.a.createElement(O.a.Control,{onChange:e.inputChange,value:e.password,name:"password",type:"password"})),r.a.createElement(O.a.Group,null,r.a.createElement(O.a.Label,null,"Description"),r.a.createElement(O.a.Text,{className:"text-muted"},"Tell us a bit about yourself."),r.a.createElement(O.a.Control,{as:"textarea",onChange:e.inputChange,value:e.aboutMe,name:"aboutMe",type:"text"})),r.a.createElement(O.a.Group,null,r.a.createElement(O.a.Label,null,"Avatar (file)"),r.a.createElement(O.a.Control,{name:"avatar",type:"file",onChange:e.fileUpload})),r.a.createElement(I.a,{variant:"dark",type:"submit"},"Done!")))))},U=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).handleFileUpload=function(e){var t=new FormData;t.append("photo",e.target.files[0]),n.filesService.handleUpload(t).then((function(e){console.log("Subida de archivo finalizada! La URL de Cloudinary es: ",e.data.secure_url),n.setState({avatar:e.data.secure_url})})).catch((function(e){return console.log(e)}))},n.handleInputChange=function(e){var t=e.target,a=t.name,r=t.value;n.setState(Object(k.a)({},a,r))},n.handleFormSubmit=function(e){e.preventDefault(),n.authService.signup(n.state).then((function(e){n.props.setTheUser(e.data),n.props.history.push("/")})).catch((function(e){return console.log(e.response.data.message)}))},n.state={username:"",password:"",avatar:"",aboutMe:""},n.authService=new h,n.filesService=new C,n}return Object(i.a)(a,[{key:"render",value:function(){return r.a.createElement(L,Object.assign({},this.state,{onSubmit:this.handleFormSubmit,fileUpload:this.handleFileUpload,inputChange:this.handleInputChange}))}}]),a}(n.Component),N=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).handleInputChange=function(e){var t=e.target,a=t.name,r=t.value;n.setState(Object(k.a)({},a,r))},n.handleFormSubmit=function(e){e.preventDefault(),n.authService.login(n.state).then((function(e){n.props.setTheUser(e.data),n.props.history.push("/")})).catch((function(e){return console.log(e.response.data.message)}))},n.state={username:"",password:""},n.authService=new h,n}return Object(i.a)(a,[{key:"render",value:function(){return r.a.createElement(j.a,{as:"main"},r.a.createElement(R.a,null,r.a.createElement(w.a,{md:{offset:3,span:6}},r.a.createElement("h3",null,"Log In"),r.a.createElement("hr",null),r.a.createElement(O.a,{onSubmit:this.handleFormSubmit},r.a.createElement(O.a.Group,null,r.a.createElement(O.a.Label,null,"User Name"),r.a.createElement(O.a.Control,{onChange:this.handleInputChange,value:this.state.username,name:"username",type:"text"})),r.a.createElement(O.a.Group,null,r.a.createElement(O.a.Label,null,"Password"),r.a.createElement(O.a.Control,{onChange:this.handleInputChange,value:this.state.password,name:"password",type:"password"})),r.a.createElement(I.a,{variant:"dark",type:"submit"},"Log In")))))}}]),a}(n.Component),F=function e(){var t=this;Object(c.a)(this,e),this.getUser=function(e){return t.service.get("/getUser/".concat(e))},this.editUser=function(e){return t.service.put("/editProfile",e)},this.getAllRoutes=function(){return t.service.get("/getAllRoutes")},this.getOneRoute=function(e){return t.service.get("/getOneRoute/".concat(e))},this.getMyRoutes=function(e){return t.service.get("/getMyRoutes/".concat(e))},this.createRoute=function(e){return t.service.post("/createNewRoute",e)},this.addPoint=function(e){return t.service.post("/addPoint",e)},this.addRock=function(e){return t.service.post("/addRock",e)},this.getOnePoint=function(e){return t.service.get("/getOnePoint/".concat(e))},this.editRoute=function(e){return t.service.put("/editRoute",e)},this.editPoint=function(e){return t.service.put("/editPoint",e)},this.editRock=function(e){return t.service.put("/editRock",e)},this.deleteRoute=function(e){return t.service.post("/deleteRoute",e)},this.deletePoint=function(e){return t.service.post("/deletePoint",e)},this.deleteRock=function(e){return t.service.post("/deleteRock",e)},this.service=d.a.create({baseURL:"".concat("https://geomapping-1.herokuapp.com/api","/routes"),withCredentials:!0})},T=a(42),D=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={points:e.props.markers},e}return Object(i.a)(a,[{key:"render",value:function(){return r.a.createElement(T.GoogleMap,{mapTypeId:"satellite",defaultCenter:this.props.defaultCenter,defaultZoom:this.props.defaultZoom},r.a.createElement(T.Polyline,{path:this.state.points,geodesic:!0,options:{strokeColor:"#ff2527",strokeOpacity:.75,strokeWeight:2}}),this.state.points.map((function(e){return r.a.createElement(T.Marker,{position:{lat:e.lat,lng:e.lng},label:e.name})})))}}]),a}(r.a.Component),M=Object(T.withScriptjs)(Object(T.withGoogleMap)(D)),_="".concat("AIzaSyDq34sAhjDIRsBySpw92CgvTmo8mW8Mwt8"),x=function(e){var t=e.points.map((function(e){return{lat:parseFloat(e.location.lat),lng:parseFloat(e.location.lng),name:e.name}})),a=Math.ceil(t.length/2)-1,n=t[a].lat,o=t[a].lng,l=e.loadingElement,c=e.containerElement,i=e.mapElement,s=e.defaultCenter,u=e.defaultZoom;return r.a.createElement(r.a.Fragment,null,r.a.createElement(M,{googleMapURL:"https://maps.googleapis.com/maps/api/js?key="+_+"&libraries=geometry,drawing,places",markers:t,loadingElement:l||r.a.createElement("div",{style:{height:"100%"}}),containerElement:c||r.a.createElement("div",{style:{height:"600px"}}),mapElement:i||r.a.createElement("div",{style:{height:"100%"}}),defaultCenter:s||{lat:n,lng:o},defaultZoom:u||20}),r.a.createElement(v.b,{to:"/routeDetails/".concat(e._id)}))},P=a(17),G=a(19),A=a(82),B=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).handleInputChange=function(e){var t=e.target,a=t.name,r=t.value;n.setState(Object(k.a)({},a,r))},n.handleFileUpload=function(e){var t=new FormData;t.append("photo",e.target.files[0]),n.filesService.handleUpload(t).then((function(e){console.log("Subida de archivo finalizada! La URL de Cloudinary es: ",e.data.secure_url),n.setState({avatar:e.data.secure_url})})).catch((function(e){return console.log(e)}))},n.handleFormSubmit=function(e){e.preventDefault(),n.routeService.editUser(n.state).then((function(){return n.props.handleUserSubmit()})).catch((function(e){return console.log(e)}))},n.state={userId:n.props._id,username:n.props.username,password:"",avatar:n.props.avatar,aboutMe:n.props.aboutMe},n.routeService=new F,n.filesService=new C,n}return Object(i.a)(a,[{key:"render",value:function(){return r.a.createElement(L,Object.assign({},this.state,{onSubmit:this.handleFormSubmit,fileUpload:this.handleFileUpload,inputChange:this.handleInputChange}))}}]),a}(n.Component),Z=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).componentDidMount=function(){return n.getAllInfo()},n.getAllInfo=function(){n.routeService.getUser(n.state.userId).then((function(e){return n.setState({userData:e.data})})).catch((function(e){return console.log(e)})),n.routeService.getMyRoutes(n.state.userId).then((function(e){var t=[];e.data.filter((function(e){return e.points.length>0?t.push(e):null})),n.setState({userRoutes:t})})).catch((function(e){return console.log(e)}))},n.handleModal=function(e){return n.setState({showModal:e})},n.handleUserSubmit=function(){n.handleModal(!1),n.getAllInfo()},n.state={loggedUser:n.props.loggedInUser._id,userId:n.props.match.params.id,userData:void 0,showModal:!1},n.routeService=new F,n}return Object(i.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,this.state.userRoutes?r.a.createElement(R.a,{className:"profileInfo"},r.a.createElement(w.a,{md:4},r.a.createElement("img",{className:"profileImg",src:this.state.userData.avatar,alt:"profileImg"})),r.a.createElement(w.a,{md:8},r.a.createElement("h1",null,this.state.userData.username),r.a.createElement("p",null,this.state.userData.aboutMe))):r.a.createElement(P.a,{animation:"grow",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading...")),this.state.userId!==this.state.loggedUser?r.a.createElement(j.a,null,r.a.createElement("h2",{className:"innerTitle"},"Routes"),r.a.createElement(R.a,null,this.state.userRoutes?this.state.userRoutes.map((function(e){return r.a.createElement(w.a,{className:"route",md:4},r.a.createElement(G.a,{bg:"dark",text:"white",className:"routeCard"},r.a.createElement(x,Object.assign({defaultZoom:15},e)),r.a.createElement(G.a.Body,null,r.a.createElement(G.a.Title,null,e.name),r.a.createElement("small",null,e.description),r.a.createElement(v.b,{to:"/routeDetails/".concat(e._id),className:"btn btn-primary btn-block btn-sm"},"See Details"))))})):r.a.createElement(P.a,{animation:"grow",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading...")))):r.a.createElement("div",{className:"editRoute"},r.a.createElement(I.a,{onClick:function(){return e.handleModal(!0)},variant:"dark",size:"sm",style:{marginBottom:"20px"}},"Edit your profile!")),r.a.createElement(A.a,{size:"lg",show:this.state.showModal,onHide:function(){return e.handleModal(!1)}},r.a.createElement(A.a.Body,null,r.a.createElement(B,Object.assign({},this.state.userData,{handleUserSubmit:this.handleUserSubmit})))))}}]),a}(n.Component),z=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={points:e.props.markers,selectedRoute:null},e.setSelectedRoute=function(t){e.setState({selectedRoute:t})},e}return Object(i.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(T.GoogleMap,{mapTypeId:"satellite",defaultCenter:this.props.defaultCenter,defaultZoom:this.props.defaultZoom,options:function(e){return{mapTypeId:"satellite"}}},this.state.points.map((function(t){return r.a.createElement(T.Marker,{position:{lat:t.lat,lng:t.lng},onClick:function(){return e.setSelectedRoute(t)}})}))),this.state.selectedRoute&&r.a.createElement(T.InfoWindow,{onCloseClick:function(){return e.setSelectedRoute(null)},position:{lat:this.state.selectedRoute.lat,lng:this.state.selectedRoute.lng}},r.a.createElement(r.a.Fragment,null,r.a.createElement(v.b,{to:"routeDetails/".concat(this.state.selectedRoute.routeId)},"Route: ",this.state.selectedRoute.name))))}}]),a}(r.a.Component),W=Object(T.withScriptjs)(Object(T.withGoogleMap)(z)),H="".concat("AIzaSyDq34sAhjDIRsBySpw92CgvTmo8mW8Mwt8"),J=function(e){var t=e.routes.map((function(e){return{lat:parseFloat(e.points[0].location.lat),lng:parseFloat(e.points[0].location.lng),name:e.name,routeId:e._id}})),a=e.centerLoc.lat,n=e.centerLoc.lng,o=e.loadingElement,l=e.containerElement,c=e.mapElement,i=e.defaultCenter,s=e.defaultZoom;return r.a.createElement(W,{googleMapURL:"https://maps.googleapis.com/maps/api/js?key="+H+"&libraries=geometry,drawing,places",markers:t,loadingElement:o||r.a.createElement("div",{style:{height:"inherit"}}),containerElement:l||r.a.createElement("div",{style:{height:"inherit"}}),mapElement:c||r.a.createElement("div",{style:{height:"inherit"}}),defaultCenter:i||{lat:a,lng:n},defaultZoom:s||20})},K=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).componentDidMount=function(){n.updateRouteList(),n.geolocation()},n.updateRouteList=function(){n.routeService.getAllRoutes().then((function(e){var t=[];e.data.filter((function(e){return e.points.length>0?t.push(e):null})),n.setState({routes:t})})).catch((function(e){return console.log(e)}))},n.state={routes:void 0,location:void 0},n.routeService=new F,n}return Object(i.a)(a,[{key:"geolocation",value:function(){var e=this;navigator.geolocation.getCurrentPosition((function(t){e.setState({location:{lat:t.coords.latitude,lng:t.coords.longitude}})}))}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,this.state.location?r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",{className:"innerTitle"},"Routes around you"),r.a.createElement("div",{className:"generalMap"},this.state.routes?r.a.createElement(J,{defaultZoom:10,routes:this.state.routes,centerLoc:this.state.location}):r.a.createElement(P.a,{animation:"grow",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading..."))),r.a.createElement(j.a,null,r.a.createElement("h2",{className:"innerTitle"},"Routes of all the users"),r.a.createElement(R.a,{className:"allRoutes"},this.state.routes?this.state.routes.map((function(e){return r.a.createElement(w.a,{className:"route",md:4},r.a.createElement(G.a,{bg:"dark",text:"white",className:"routeCard"},r.a.createElement(x,Object.assign({defaultZoom:15},e)),r.a.createElement(G.a.Body,null,r.a.createElement(G.a.Title,null,e.name),r.a.createElement("small",null,e.description),r.a.createElement(v.b,{to:"/routeDetails/".concat(e._id),className:"btn btn-primary btn-block btn-sm"},"See Details"))))})):r.a.createElement(P.a,{animation:"grow",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading..."))))):r.a.createElement(P.a,{animation:"grow",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading...")))}}]),a}(n.Component),Y=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(R.a,{className:"title"},r.a.createElement("section",null,r.a.createElement("h1",null,r.a.createElement("span",null,r.a.createElement("img",{className:"topLogo",src:S.a,alt:"GeologistLogo"}),"GeoMapping_")),r.a.createElement("p",{className:"subtitle"},"The new connecting tool for Geologists."))),r.a.createElement(R.a,{className:"share section"},r.a.createElement(w.a,{md:6,className:"img"},r.a.createElement("section",{className:"sectionText"},r.a.createElement("h2",null,r.a.createElement("span",null,"Share your Field investigations")),r.a.createElement("p",{className:"p-presentation"},"Join a community where Geologists can share their investigation in the field, using Google maps integration to create routes with points of observation, all while working.")))),r.a.createElement(R.a,{className:"mapImg section"},r.a.createElement(w.a,{md:6}),r.a.createElement(w.a,{md:6},r.a.createElement("section",{className:"sectionText"},r.a.createElement("h2",null,r.a.createElement("span",null,"Access to information around you")),r.a.createElement("p",{className:"p-presentation"},"With Geolocation enabled, you can see other routes and check the information other Geologists have collected.")))),r.a.createElement(R.a,{className:"signup"},r.a.createElement(w.a,{md:4},r.a.createElement("section",{className:"sectionText"},r.a.createElement("h2",null,r.a.createElement("span",null,"Ready?")),r.a.createElement("p",{className:"p-presentation"},"Join us."))),r.a.createElement(w.a,{md:4},r.a.createElement(v.b,{className:"signUpBtn",to:"/signup"},"Sign Up")),r.a.createElement(w.a,{md:4},r.a.createElement("img",{className:"bottomLogo",src:S.a,alt:"GeologistLogo"}))))},q=function(e){return r.a.createElement(O.a,{onSubmit:e.onSubmit},r.a.createElement(O.a.Group,null,r.a.createElement(O.a.Label,null,"Route Name"),r.a.createElement(O.a.Control,{onChange:e.inputChange,value:e.name,name:"name",type:"text"})),r.a.createElement(O.a.Group,null,r.a.createElement(O.a.Label,null,"Description of the Route"),r.a.createElement(O.a.Control,{as:"textarea",onChange:e.inputChange,value:e.description,name:"description",type:"text"})),r.a.createElement(I.a,{variant:"dark",type:"submit"},"Done!"))},X=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).handleInputChange=function(e){var t=e.target,a=t.name,r=t.value;n.setState(Object(k.a)({},a,r))},n.handleFormSubmit=function(e){e.preventDefault(),n.routeService.createRoute(n.state).then((function(e){n.props.history.push("/routeCreation/".concat(e.data._id))})).catch((function(e){return console.log(e.response.data.message)}))},n.state={name:"",description:"",owner:e.loggedInUser._id,points:[]},n.routeService=new F,n}return Object(i.a)(a,[{key:"render",value:function(){return r.a.createElement(j.a,{as:"main"},r.a.createElement(R.a,null,r.a.createElement(w.a,{md:{offset:3,span:6}},r.a.createElement("h3",null,"New Route"),r.a.createElement("hr",null),r.a.createElement(q,Object.assign({},this.state,{onSubmit:this.handleFormSubmit,inputChange:this.handleInputChange})))))}}]),a}(n.Component),Q=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).componentDidMount=function(){return n.updateRouteList()},n.updateRouteList=function(){n.routeService.getMyRoutes(n.state.userId).then((function(e){var t=[];e.data.filter((function(e){return e.points.length>0?t.push(e):null})),n.setState({routes:t})})).catch((function(e){return console.log(e)}))},n.state={userId:e.loggedInUser._id,routes:void 0},n.routeService=new F,n}return Object(i.a)(a,[{key:"render",value:function(){return r.a.createElement(j.a,null,r.a.createElement("h2",{className:"innerTitle"},"Your Routes"),r.a.createElement(R.a,null,this.state.routes?this.state.routes.map((function(e){return r.a.createElement(w.a,{className:"route",md:4},r.a.createElement(G.a,{bg:"dark",text:"white",className:"routeCard"},r.a.createElement(x,Object.assign({defaultZoom:15},e)),r.a.createElement(G.a.Body,null,r.a.createElement(G.a.Title,null,e.name),r.a.createElement("small",null,e.description),r.a.createElement(v.b,{to:"/routeDetails/".concat(e._id),className:"btn btn-primary btn-block btn-sm"},"See Details"))))})):r.a.createElement(P.a,{animation:"grow",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading..."))))}}]),a}(n.Component),V=function(e){return r.a.createElement(O.a,{onSubmit:e.onSubmit},r.a.createElement(O.a.Group,null,r.a.createElement(O.a.Label,null,"Lat"),r.a.createElement(O.a.Control,{onChange:e.inputChange,value:e.lat,name:"lat",type:"text"}),r.a.createElement(O.a.Label,null,"Lon"),r.a.createElement(O.a.Control,{onChange:e.inputChange,value:e.lng,name:"lng",type:"text"})),r.a.createElement(O.a.Group,null,r.a.createElement(O.a.Label,null,"Name of the point"),r.a.createElement(O.a.Control,{onChange:e.inputChange,value:e.name,name:"name",type:"text"})),r.a.createElement(I.a,{variant:"dark",type:"submit"},"Done!"))},$=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).componentDidMount=function(){return n.geolocation()},n.handleInputChange=function(e){var t=e.target,a=t.name,r=t.value;n.setState(Object(k.a)({},a,r))},n.handleFormSubmit=function(e){n.geolocation(),e.preventDefault(),n.routeService.addPoint(n.state).then((function(){return n.props.updatePointList()})).catch((function(e){return console.log(e.response.data.message)}))},n.state={routeId:e.match.params.id,name:void 0,lat:void 0,lng:void 0,rocks:[]},n.routeService=new F,n}return Object(i.a)(a,[{key:"geolocation",value:function(){var e=this;navigator.geolocation.getCurrentPosition((function(t){e.setState({lat:t.coords.latitude,lng:t.coords.longitude})}))}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(R.a,null,r.a.createElement(w.a,{md:6},r.a.createElement("h3",null,"New Point"),r.a.createElement("hr",null),r.a.createElement(V,Object.assign({},this.state,{onSubmit:this.handleFormSubmit,inputChange:this.handleInputChange})))))}}]),a}(n.Component),ee=function(e){return r.a.createElement(O.a,{onSubmit:e.onSubmit},r.a.createElement(O.a.Group,null,r.a.createElement(O.a.Label,null,"Name"),r.a.createElement(O.a.Control,{onChange:e.inputChange,value:e.name,name:"name",type:"text"})),r.a.createElement(O.a.Group,{controlId:"exampleForm.ControlSelect1"},r.a.createElement(O.a.Label,null,"Type of Rock"),r.a.createElement(O.a.Control,{as:"select",onChange:e.inputChange,value:e.rockType,name:"rockType",type:"text"},r.a.createElement("option",{value:"Sedimentary"},"Sedimentary"),r.a.createElement("option",{value:"Igneous"},"Igneous"),r.a.createElement("option",{value:"Metamorphic"},"Metamorphic"))),r.a.createElement(O.a.Group,null,r.a.createElement(O.a.Label,null,"Description"),r.a.createElement(O.a.Control,{onChange:e.inputChange,value:e.description,name:"description",type:"text"})),r.a.createElement(O.a.Group,null,r.a.createElement(O.a.Label,null,"Samples"),r.a.createElement(O.a.Control,{onChange:e.inputChange,value:e.samplesId,name:"samplesId",type:"text"})),r.a.createElement(O.a.Group,null,r.a.createElement(O.a.Label,null,"Photos"),r.a.createElement(O.a.Control,{onChange:e.fileUpload,name:"photos",type:"file"}),r.a.createElement("p",null,"Added photos: "),e.photos.map((function(e){return r.a.createElement("img",{className:"rockImg",src:e})}))),r.a.createElement(O.a.Group,null,r.a.createElement(O.a.Label,null,"Directions"),r.a.createElement(O.a.Text,{className:"text-muted"},"Type of data"),r.a.createElement(O.a.Control,{onChange:e.inputChange,value:e.dataType,name:"dataType",type:"text"}),r.a.createElement(O.a.Text,{className:"text-muted"},"Data"),r.a.createElement(O.a.Control,{onChange:e.inputChange,value:e.data,name:"data",type:"text"})),r.a.createElement(I.a,{variant:"dark",type:"submit"},"Done!"))},te=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).handleInputChange=function(e){var t=e.target,a=t.name,r=t.value;n.setState(Object(k.a)({},a,r))},n.handleFileUpload=function(e){var t=new FormData;t.append("photo",e.target.files[0]),n.filesService.handleUpload(t).then((function(e){console.log("Subida de archivo finalizada! La URL de Cloudinary es: ",e.data.secure_url),n.setState({photos:n.state.photos.concat(e.data.secure_url)})})).catch((function(e){return console.log(e)}))},n.handleFormSubmit=function(e){e.preventDefault(),n.routeService.addRock(n.state).then((function(){return n.props.handleRockSubmit()})).catch((function(e){return console.log(e)}))},n.state={pointId:e.pointIdClicked,name:"",rockType:"",description:"",samplesId:"",photos:[],dataType:"",data:""},n.routeService=new F,n.filesService=new C,n}return Object(i.a)(a,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",null,"Add a new rock to this point"),r.a.createElement("hr",null),r.a.createElement(ee,Object.assign({},this.state,{onSubmit:this.handleFormSubmit,fileUpload:this.handleFileUpload,inputChange:this.handleInputChange})))}}]),a}(n.Component),ae=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).componentDidMount=function(){return n.updatePointList()},n.updatePointList=function(){n.routeService.getOneRoute(n.state.routeId).then((function(e){n.setState({route:e.data}),e.data.points.length>0&&n.setState({hasPoints:!0})})).catch((function(e){return console.log(e)}))},n.handleModal=function(e){return n.setState({showModal:e})},n.pointIdClicked=function(e){return n.setState({pointIdClicked:e})},n.handleRockSubmit=function(){n.handleModal(!1),n.updatePointList()},n.state={routeId:e.match.params.id,route:void 0,hasPoints:!1,pointIdClicked:void 0,showModal:!1},n.routeService=new F,n}return Object(i.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",{className:"innerTitle"},"Add points to the route while you are working!"),r.a.createElement(R.a,null,r.a.createElement(w.a,{md:6},r.a.createElement("div",{className:"detailMap"},this.state.hasPoints?r.a.createElement(x,Object.assign({defaultZoom:15},this.state.route)):r.a.createElement(P.a,{animation:"grow",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading...")))),r.a.createElement(w.a,{md:6},r.a.createElement($,Object.assign({},this.props,{updatePointList:this.updatePointList,routeId:this.state.routeId})),r.a.createElement("h3",null,"Points added:"),r.a.createElement("hr",null),this.state.route?r.a.createElement(r.a.Fragment,null,this.state.route.points.map((function(t){return r.a.createElement(I.a,{key:t._id,onClick:function(){e.handleModal(!0),e.pointIdClicked(t._id)},variant:"dark",size:"sm",style:{marginBottom:"20px"}},t.name)}))):r.a.createElement(P.a,{animation:"grow",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading...")))),r.a.createElement(A.a,{size:"lg",show:this.state.showModal,onHide:function(){return e.handleModal(!1)}},r.a.createElement(A.a.Body,null,r.a.createElement(te,{pointIdClicked:this.state.pointIdClicked,handleRockSubmit:this.handleRockSubmit}))))}}]),a}(n.Component),ne=a(64),re=a(271),oe=function(e){var t=[{id:"sedimentary",label:"Sedimentary",value:e.countRocks.Sedimentary,color:"hsl(107, 70%, 50%)"},{id:"igneous",label:"Igneous",value:e.countRocks.Igneous,color:"hsl(68, 70%, 50%)"},{id:"metamorphic",label:"Metamorphic",value:e.countRocks.Metamorphic,color:"hsl(312, 70%, 50%)"}];return r.a.createElement(re.a,{data:t,margin:{top:40,right:80,bottom:80,left:80},startAngle:-180,endAngle:354,innerRadius:.7,padAngle:0,cornerRadius:0,colors:{scheme:"nivo"},borderWidth:1,borderColor:{from:"color",modifiers:[["darker","0.5"]]},radialLabelsSkipAngle:14,radialLabelsTextXOffset:16,radialLabelsTextColor:"#333333",radialLabelsLinkOffset:-9,radialLabelsLinkDiagonalLength:16,radialLabelsLinkHorizontalLength:24,radialLabelsLinkStrokeWidth:1,radialLabelsLinkColor:{from:"color"},slicesLabelsSkipAngle:15,slicesLabelsTextColor:"#333333",animate:!0,motionStiffness:90,motionDamping:15,legends:[{anchor:"bottom",direction:"row",translateY:56,itemWidth:100,itemHeight:18,itemTextColor:"#999",symbolSize:18,symbolShape:"circle",effects:[{on:"hover",style:{itemTextColor:"#000"}}]}]})},le=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).componentDidMount=function(){n.getRouteInfo()},n.getRouteInfo=function(){n.routeService.getOneRoute(n.state.routeId).then((function(e){n.setState({route:e.data}),e.data.points.map((function(e){n.routeService.getOnePoint(e._id).then((function(e){n.setState({points:n.state.points.concat(e.data).sort((function(e,t){return e._id>t._id?1:-1}))}),n.rockTypeCount(e.data)}))}))})).then((function(){return setTimeout((function(){return n.setState({isFinished:!0})}),500)})).catch((function(e){return console.log(e)}))},n.rockTypeCount=function(e){e.rocks.map((function(e){"Sedimentary"===e.rockType&&(n.state.countRocks.hasOwnProperty("Sedimentary")?n.state.countRocks.Sedimentary+=1:n.state.countRocks.Sedimentary=1),"Igneous"===e.rockType&&(n.state.countRocks.hasOwnProperty("Igneous")?n.state.countRocks.Igneous+=1:n.state.countRocks.Igneous=1),"Metamorphic"===e.rockType&&(n.state.countRocks.hasOwnProperty("Metamorphic")?n.state.countRocks.Metamorphic+=1:n.state.countRocks.Metamorphic=1)}))},n.state={userId:e.loggedInUser._id,routeId:e.match.params.id,route:void 0,points:[],countRocks:{},isFinished:!1},n.routeService=new F,n}return Object(i.a)(a,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,this.state.route?r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",{className:"innerTitle"},this.state.route.name),r.a.createElement(R.a,{className:"map-data"},r.a.createElement(w.a,{md:6},r.a.createElement("div",{className:"detailMap"},r.a.createElement(x,Object.assign({defaultZoom:15},this.state.route))),r.a.createElement("div",{className:"ownerTag"},r.a.createElement("small",null,r.a.createElement("i",null,"Owner of this Route: ")," ",r.a.createElement(v.b,{to:"/profile/".concat(this.state.route.owner._id)},r.a.createElement("img",{className:"userImg",src:this.state.route.owner.avatar}))))),r.a.createElement(w.a,{md:6},r.a.createElement("div",{className:"container",style:{height:"500px"}},this.state.isFinished?r.a.createElement(oe,{countRocks:this.state.countRocks}):r.a.createElement(P.a,{animation:"grow",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading..."))))),r.a.createElement("h2",{className:"innerTitle"},"Points of the route"),r.a.createElement(j.a,null,r.a.createElement(ne.a,null,this.state.points.map((function(e,t){return r.a.createElement(G.a,null,r.a.createElement(ne.a.Toggle,{as:G.a.Header,eventKey:"".concat(t)},r.a.createElement("h4",null,"Point: ",e.name),r.a.createElement("small",null,"Lat: ",e.location.lat," | Lng: ",e.location.lng)),r.a.createElement(ne.a.Collapse,{eventKey:"".concat(t)},r.a.createElement(G.a.Body,null,e.rocks.map((function(e,t){return r.a.createElement("div",{key:t},r.a.createElement("h3",null,"Rocks in this point:"),r.a.createElement("hr",null),r.a.createElement("p",null,r.a.createElement("b",null,"Name: "),e.name),r.a.createElement("p",null,r.a.createElement("b",null,"Description: "),e.description),r.a.createElement("p",null,r.a.createElement("b",null,"Directions: "),e.directions.dataType,"(",e.directions.data,")"),r.a.createElement("p",null,r.a.createElement("b",null,"Photos:")),e.photos.map((function(e,t){return r.a.createElement("img",{className:"rockImg",src:e,alt:"RockImg"})})))})))))})))),r.a.createElement("div",{className:"editRoute"},this.state.userId===this.state.route.owner._id?r.a.createElement(v.b,{className:"editBtn",to:"/routeEdit/".concat(this.state.routeId)},"Edit this route!"):null)):r.a.createElement(P.a,{animation:"grow",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading...")))}}]),a}(n.Component),ce=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).handleInputChange=function(e){var t=e.target,a=t.name,r=t.value;n.setState(Object(k.a)({},a,r))},n.handleFormSubmit=function(e){e.preventDefault(),n.routeService.editRoute(n.state).catch((function(e){return console.log(e.response.data.message)}))},n.state={id:e._id,name:e.name,description:e.description},n.routeService=new F,n}return Object(i.a)(a,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(q,Object.assign({},this.state,{onSubmit:this.handleFormSubmit,inputChange:this.handleInputChange})))}}]),a}(n.Component),ie=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).handleInputChange=function(e){var t=e.target,a=t.name,r=t.value;n.setState(Object(k.a)({},a,r))},n.handleFormSubmit=function(e){e.preventDefault(),n.routeService.editPoint(n.state).then((function(){return n.props.handleFormSubmit()})).catch((function(e){return console.log(e)}))},n.state={pointId:e.point._id,name:e.point.name,lat:e.point.location.lat,lng:e.point.location.lng},n.routeService=new F,n}return Object(i.a)(a,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,this.state.name?r.a.createElement(V,Object.assign({},this.state,{inputChange:this.handleInputChange,onSubmit:this.handleFormSubmit})):r.a.createElement(P.a,{animation:"grow",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading...")))}}]),a}(n.Component),se=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).handleInputChange=function(e){var t=e.target,a=t.name,r=t.value;n.setState(Object(k.a)({},a,r))},n.handleFileUpload=function(e){var t=new FormData;t.append("photo",e.target.files[0]),n.filesService.handleUpload(t).then((function(e){console.log("Subida de archivo finalizada! La URL de Cloudinary es: ",e.data.secure_url),n.setState({photos:n.state.photos.concat(e.data.secure_url)})})).catch((function(e){return console.log(e)}))},n.handleFormSubmit=function(e){e.preventDefault(),n.routeService.editRock(n.state).then((function(){return n.props.handleFormSubmit()})).catch((function(e){return console.log(e)}))},n.state={rockId:e.rock._id,name:e.rock.name,rockType:e.rock.rockType,description:e.rock.description,samplesId:e.rock.samplesId,photos:e.rock.photos,dataType:e.rock.directions.dataType,data:e.rock.directions.data},n.routeService=new F,n.filesService=new C,n}return Object(i.a)(a,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(ee,Object.assign({},this.state,{onSubmit:this.handleFormSubmit,fileUpload:this.handleFileUpload,inputChange:this.handleInputChange})))}}]),a}(n.Component),ue=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).componentDidMount=function(){n.getRouteInfo()},n.getRouteInfo=function(){n.setState({points:[]}),n.routeService.getOneRoute(n.state.routeId).then((function(e){n.setState({route:e.data,ownerId:e.data.owner}),e.data.points.map((function(e){n.routeService.getOnePoint(e._id).then((function(e){return n.setState({points:n.state.points.concat(e.data).sort((function(e,t){return e._id>t._id?1:-1}))})}))}))})).catch((function(e){return console.log(e)}))},n.handleFormSubmit=function(){n.getRouteInfo()},n.deleteRoute=function(){var e=[],t=[];n.state.points.map((function(a){e.push(a._id),a.rocks.map((function(e){return t.push(e._id)}))}));var a={route:n.state.routeId,points:e,rocks:t};n.routeService.deleteRoute(a).then((function(e){return n.props.history.push("/myRoutes")})).catch((function(e){return console.log(e)}))},n.deletePoint=function(e){var t=[];e.rocks.map((function(e){return t.push(e._id)}));var a={route:n.state.routeId,point:e._id,rocks:t};n.routeService.deletePoint(a).then((function(e){return n.getRouteInfo()})).catch((function(e){return console.log(e)}))},n.deleteRock=function(e,t){var a={point:t,rock:e};n.routeService.deleteRock(a).then((function(e){return n.getRouteInfo()})).catch((function(e){return console.log(e)}))},n.state={routeId:e.match.params.id,userId:e.loggedInUser._id,ownerId:void 0,route:void 0,points:[]},n.routeService=new F,n}return Object(i.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement(j.a,null,r.a.createElement("h2",{className:"innerTitle"},"Edit this Route"),this.state.route?r.a.createElement(r.a.Fragment,null,r.a.createElement(ce,this.state.route),r.a.createElement(I.a,{className:"deleteBtn",onClick:function(){return e.deleteRoute()}},"Delete this route"),r.a.createElement(ne.a,null,this.state.points?r.a.createElement(r.a.Fragment,null,this.state.points.map((function(t,a){return r.a.createElement(G.a,{key:t._id},r.a.createElement(ne.a.Toggle,{as:G.a.Header,eventKey:"".concat(a)},r.a.createElement("h4",null,"Point: ",t.name)),r.a.createElement(ne.a.Collapse,{eventKey:"".concat(a)},r.a.createElement(R.a,{className:"justify-content-md-center"},r.a.createElement(w.a,{md:10},r.a.createElement("p",{className:"innerTitle"},"Edit Point:"),r.a.createElement(ie,{point:t,handleFormSubmit:e.handleFormSubmit}),r.a.createElement(I.a,{className:"deleteBtn",onClick:function(){return e.deletePoint(t)}},"Delete this point"),r.a.createElement("hr",null),r.a.createElement("p",{className:"innerTitle"},"Rocks in this point:"),t.rocks.map((function(a){return r.a.createElement("div",{key:a._id},r.a.createElement(se,{rock:a,handleFormSubmit:e.handleFormSubmit}),r.a.createElement(I.a,{className:"deleteBtn",onClick:function(){return e.deleteRock(a._id,t._id)}},"Delete this rock"),r.a.createElement("hr",null))}))))))}))):r.a.createElement(P.a,{animation:"grow",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading...")))):r.a.createElement(P.a,{animation:"grow",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading...")))}}]),a}(n.Component),me=function(e){Object(s.a)(a,e);var t=Object(u.a)(a);function a(){var e;return Object(c.a)(this,a),(e=t.call(this)).setTheUser=function(t){return e.setState({loggedInUser:t},(function(){return console.log("El estado de App ha cambiado:",e.state)}))},e.fetchUser=function(){e.AuthService.isLoggedIn().then((function(t){return null===e.state.loggedInUser&&e.setState({loggedInUser:t.data})})).catch((function(e){return console.log({err:e})}))},e.state={loggedInUser:null},e.AuthService=new h,e}return Object(i.a)(a,[{key:"render",value:function(){var e=this;return this.fetchUser(),r.a.createElement("div",{className:"contain"},r.a.createElement("div",{className:"content"},r.a.createElement(y,{setTheUser:this.setTheUser,loggedInUser:this.state.loggedInUser}),r.a.createElement(p.c,null,r.a.createElement(p.a,{exact:!0,path:"/",render:function(){return e.state.loggedInUser?r.a.createElement(K,null):r.a.createElement(Y,null)}}),r.a.createElement(p.a,{path:"/login",render:function(t){return r.a.createElement(N,Object.assign({},t,{setTheUser:e.setTheUser}))}}),r.a.createElement(p.a,{path:"/signup",render:function(t){return r.a.createElement(U,Object.assign({},t,{setTheUser:e.setTheUser}))}}),r.a.createElement(p.a,{path:"/profile/:id",render:function(t){return e.state.loggedInUser?r.a.createElement(Z,Object.assign({},t,{loggedInUser:e.state.loggedInUser})):r.a.createElement(Y,null)}}),r.a.createElement(p.a,{path:"/createRoute",render:function(t){return e.state.loggedInUser?r.a.createElement(X,Object.assign({},t,{loggedInUser:e.state.loggedInUser})):r.a.createElement(Y,null)}}),r.a.createElement(p.a,{path:"/myRoutes",render:function(t){return e.state.loggedInUser?r.a.createElement(Q,Object.assign({},t,{loggedInUser:e.state.loggedInUser})):r.a.createElement(Y,null)}}),r.a.createElement(p.a,{path:"/routeCreation/:id",render:function(t){return e.state.loggedInUser?r.a.createElement(ae,Object.assign({},t,{loggedInUser:e.state.loggedInUser})):r.a.createElement(Y,null)}}),r.a.createElement(p.a,{path:"/routeDetails/:id",render:function(t){return e.state.loggedInUser?r.a.createElement(le,Object.assign({},t,{loggedInUser:e.state.loggedInUser})):r.a.createElement(Y,null)}}),r.a.createElement(p.a,{path:"/routeEdit/:id",render:function(t){return e.state.loggedInUser?r.a.createElement(ue,Object.assign({},t,{loggedInUser:e.state.loggedInUser})):r.a.createElement(Y,null)}}))),r.a.createElement("footer",{className:"footer"},r.a.createElement("small",null,"Copyright \xa92020 Ignacio Serrano & David Roel G\xf3mez")))}}]),a}(n.Component);l.a.render(r.a.createElement(v.a,null,r.a.createElement(r.a.StrictMode,null,r.a.createElement(me,null))),document.getElementById("root"))},96:function(e,t,a){e.exports=a.p+"static/media/logo.73963d7d.png"}},[[276,1,2]]]);
//# sourceMappingURL=main.9f50d169.chunk.js.map